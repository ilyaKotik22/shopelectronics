generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // –∏–ª–∏ mysql / sqlite,
  

}

//////////////////////////////////////////////////////
// ENUMS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
//////////////////////////////////////////////////////

enum Currency {
  RUB
  USD
  EUR
}

//////////////////////////////////////////////////////
// –û–°–ù–û–í–ù–´–ï –ú–û–î–ï–õ–ò
//////////////////////////////////////////////////////

model Category {
  slug      String   @id                // smartfony-i-fototekhnika
  value     String                       // smartphones-and-photo
  name      String                       // –°–º–∞—Ä—Ç—Ñ–æ–Ω—ã –∏ —Ñ–æ—Ç–æ
  products  Product[]
}

model Brand {
  id        String    @id @default(cuid())
  name      String    @unique
  products  Product[]
}

model Product {
  id            String   @id @default(cuid())
  title         String
  description   String?
  price         Int
  currency      Currency @default(RUB)
  rating        Float?
  available     Boolean  @default(true)

  categorySlug  String
  category      Category @relation(fields: [categorySlug], references: [slug])

  brandId       String?
  brand         Brand?   @relation(fields: [brandId], references: [id])

  attributes    ProductAttribute[]

  // üîΩ –û–ë–†–ê–¢–ù–´–ï –°–í–Ø–ó–ò
  laptopSpec     LaptopSpec?
  smartphoneSpec SmartphoneSpec?
  tvSpec         TvSpec?

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([price])
  @@index([categorySlug])
}


//////////////////////////////////////////////////////
// –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ï –§–ò–õ–¨–¢–†–´ (checkbox)
//////////////////////////////////////////////////////

model ProductAttribute {
  id        String   @id @default(cuid())

  productId String
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  key       String   // ram, storage, screen_type, wifi_standard
  value     String   // "8 –ì–ë", "AMOLED", "Wi-Fi 6"

  @@index([key])
  @@index([key, value])
  @@index([productId])
}

//////////////////////////////////////////////////////
// (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û) –°–ü–ï–¶–ò–§–ò–ö–ê–¶–ò–ò –ü–û–î –ö–ê–¢–ï–ì–û–†–ò–ò
// –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–∑–∂–µ –±–µ–∑ –ª–æ–º–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
//////////////////////////////////////////////////////

model LaptopSpec {
  productId  String  @id
  product    Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  cpu        String
  ramGb      Int
  storageGb Int
  gpu        String?
}

model SmartphoneSpec {
  productId   String  @id
  product     Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  screenInch  Float?
  batteryMah  Int?
  cameraMp    Int?
  refreshHz   Int?
  waterproof  String?
}

model TvSpec {
  productId   String  @id
  product     Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  screenInch  Int?
  resolution  String
  panelType   String
  refreshHz   Int?
  smartTv     Boolean
}
